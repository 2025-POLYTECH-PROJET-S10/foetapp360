define("mod_foetapp360/attempt",["jquery"],(function($){return{init:function(){$(".rotation_foetapp360_container").each((function(){let rotationfoetapp360_container=$(this),foetapp360_container=rotationfoetapp360_container.find(".foetapp360_container");if(!foetapp360_container.length)return;let schemaType=foetapp360_container.data("schema-type");if(!schemaType)return;let targetInteriorImage=foetapp360_container.find("."+schemaType+"_interieur"),targetContourImage=foetapp360_container.find("."+schemaType+"_contour"),rotateSlider=rotationfoetapp360_container.find(".rotate-slider"),moveSlider=rotationfoetapp360_container.find(".move-axis-slider"),rotationAngle=rotateSlider.val(),translateDistance=moveSlider.val();function updateTransform(){let radian=rotationAngle*Math.PI/180,xOffset=translateDistance*Math.sin(radian),yOffset=-translateDistance*Math.cos(radian);targetInteriorImage.length&&targetInteriorImage.css("transform","translate(".concat(xOffset,"px, ").concat(yOffset,"px) rotate(").concat(rotationAngle,"deg)")),targetContourImage.length&&targetContourImage.css("transform","rotate(".concat(rotationAngle,"deg)"))}updateTransform(),rotateSlider.on("input",(function(){rotationAngle=parseInt($(this).val(),10),updateTransform()})),moveSlider.on("input",(function(){translateDistance=parseInt($(this).val(),10),updateTransform()}))}));let imageDatabase=JSON.parse(document.getElementById("image_database").dataset.values);$(".image_cycling_foetapp360_container").each((function(){let foetapp360_container=$(this),cyclingImage=foetapp360_container.find(".foetapp360_attempt_cycling-image_vue_laterale, .foetapp360_attempt_cycling-image_vue_anterieure"),hiddenInput=foetapp360_container.find(".foetapp360_attempt_selected_position"),toggleButtonHiddenInput=foetapp360_container.find(".foetapp360_attempt_toggle_btn_value");foetapp360_container.find(".foetapp360_attempt_prev-btn").on("click",(function(){!function(){let field=foetapp360_container.find(".foetapp360_field"),inclinaison=toggleButtonHiddenInput.attr("value"),images=Object.values(imageDatabase[field[0].dataset.values][inclinaison]),imageActuelle=cyclingImage.attr("src"),currentIndex=images.indexOf(imageActuelle);-1===currentIndex&&(currentIndex=0),currentIndex-=1,currentIndex<0&&(currentIndex=images.length-1),cyclingImage.attr("src",images[currentIndex]),hiddenInput.val(images[currentIndex])}()})),foetapp360_container.find(".foetapp360_attempt_next-btn").on("click",(function(){!function(){let field=foetapp360_container.find(".foetapp360_field"),inclinaison=toggleButtonHiddenInput.attr("value"),images=Object.values(imageDatabase[field[0].dataset.values][inclinaison]),imageActuelle=cyclingImage.attr("src"),currentIndex=images.indexOf(imageActuelle);-1===currentIndex&&(currentIndex=0),currentIndex+=1,currentIndex==images.length&&(currentIndex=0),cyclingImage.attr("src",images[currentIndex]),hiddenInput.val(images[currentIndex])}()})),foetapp360_container.find(".foetapp360_attempt_toggle_btn").on("click",(function(){!function(previousInclinaison){let field=foetapp360_container.find(".foetapp360_field"),images=Object.values(imageDatabase[field[0].dataset.values][previousInclinaison]),imageActuelle=cyclingImage.attr("src"),currentIndex=images.indexOf(imageActuelle),correctInclinaison=toggleButtonHiddenInput.attr("value"),imagesBonInclinaison=Object.values(imageDatabase[field[0].dataset.values][correctInclinaison]);currentIndex>=imagesBonInclinaison.length&&(currentIndex=imagesBonInclinaison.length-1),cyclingImage.attr("src",imagesBonInclinaison[currentIndex]),hiddenInput.val(imagesBonInclinaison[currentIndex])}(function(){let nextKey,inclinaison=toggleButtonHiddenInput.attr("value"),field=foetapp360_container.find(".foetapp360_field"),images=imageDatabase[field[0].dataset.values],inclinaisonKeys=Object.keys(images),currentIndex=inclinaisonKeys.indexOf(inclinaison);return nextKey=-1!==currentIndex&&currentIndex<Object.keys(images).length-1?inclinaisonKeys[currentIndex+1]:inclinaisonKeys[0],toggleButtonHiddenInput.attr("value",nextKey),inclinaison}())}))})),$(".attempt_container").hide(),$(".foetapp360-tab.active").each((function(){$($(this).data("target")).show(),$(this).addClass("foetapp360_given_tab_input")})),$(".foetapp360-tab").click((function(){$(".foetapp360-tab").removeClass("active"),$(this).addClass("active"),$(".attempt_container").hide(),$($(this).data("target")).show()})),document.getElementById("submit_attempt").addEventListener("click",(function(event){let inputs=document.querySelectorAll("#attempt_form input[type='text']"),overlay=document.getElementById("attempt_error_overlay");overlay||(overlay=document.createElement("div"),overlay.id="attempt_error_overlay",overlay.innerHTML='\n                        <p>Veuillez remplir tous les champs.</p>\n                        <button id="attempt_close_overlay">Fermer</button>\n                    ',document.body.appendChild(overlay),document.getElementById("attempt_close_overlay").addEventListener("click",(function(){overlay.style.display="none"})));for(let input of inputs)if(""===input.value.trim())return overlay.style.display="flex",void event.preventDefault();overlay.style.display="none"}))}}}));

//# sourceMappingURL=attempt.min.js.map